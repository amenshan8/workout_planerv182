const translations = {
  'en': {
    title: 'Amin Shan Science-Based Workout Plan',
    subtitle: 'A hypertrophy and strength-focused program inspired by Jeff Nippard\'s evidence-based methods',
    weeklyOverview: 'Weekly Overview',
    frequency: 'Frequency',
    split: 'Split',
    restDays: 'Rest Days',
    terminologyTitle: 'Training Terms Explained',
    sets: 'Sets',
    setsExplanation: 'A group of repetitions performed consecutively without rest. For example, "3 sets" means you\'ll perform the exercise three times with rest periods in between.',
    reps: 'Reps (Repetitions)',
    repsExplanation: 'The number of times you perform an exercise within a set. For example, "8-12 reps" means you\'ll perform the movement 8 to 12 times before resting.',
    day1: 'Day 1 - Push (Chest, Shoulders, Triceps)',
    day2: 'Day 2 - Pull (Back, Rear Delts, Biceps)',
    day3: 'Day 3 - Legs (Quads, Hamstrings, Glutes)',
    day4: 'Day 4 - Rest/Active Recovery',
    day5: 'Day 5 - Push (Higher Volume)',
    day6: 'Day 6 - Pull (Trap/Arm Focus)',
    day7: 'Day 7 - Legs (Higher Volume)',
    jumpDay1: 'Day 1',
    jumpPush1: 'Push',
    jumpDay2: 'Day 2',
    jumpPull1: 'Pull',
    jumpDay3: 'Day 3',
    jumpLegs1: 'Legs',
    jumpDay4: 'Day 4',
    jumpRest: 'Rest',
    jumpDay5: 'Day 5',
    jumpPush2: 'Push',
    jumpDay6: 'Day 6',
    jumpPull2: 'Pull',
    jumpDay7: 'Day 7',
    jumpLegs2: 'Legs',
    footer: {
      quote: '"Science meets sweat – achieve your goals!"',
      copyright: ' 2024 Amin Shan Science-Based Workout Plan'
    },
    exercises: {
      'Flat Barbell Bench Press': 'Flat Barbell Bench Press',
      'Incline Dumbbell Press': 'Incline Dumbbell Press',
      'Seated Overhead Dumbbell Press': 'Seated Overhead Dumbbell Press',
      'Lateral Raises': 'Lateral Raises',
      'Cable Tricep Pushdowns': 'Cable Tricep Pushdowns',
      'Overhead Tricep Extensions': 'Overhead Tricep Extensions',
      'Pull-Ups/Lat Pulldown': 'Pull-Ups/Lat Pulldown',
      'Barbell Row': 'Barbell Row',
      'Chest-Supported Dumbbell Row': 'Chest-Supported Dumbbell Row',
      'Face Pulls': 'Face Pulls',
      'Barbell/Dumbbell Bicep Curls': 'Barbell/Dumbbell Bicep Curls',
      'Hammer Curls': 'Hammer Curls',
      'Back Squat': 'Back Squat',
      'Romanian Deadlift': 'Romanian Deadlift',
      'Walking Lunges': 'Walking Lunges',
      'Leg Press': 'Leg Press',
      'Hamstring Curls': 'Hamstring Curls',
      'Calf Raises': 'Calf Raises',
      'Incline Barbell Bench': 'Incline Barbell Bench',
      'Flat Dumbbell Press': 'Flat Dumbbell Press',
      'Arnold Press': 'Arnold Press',
      'Cable Lateral Raises': 'Cable Lateral Raises',
      'Skull Crushers': 'Skull Crushers',
      'Dips': 'Dips',
      'Rack Pulls': 'Rack Pulls',
      'Wide-Grip Pulldown': 'Wide-Grip Pulldown',
      'Single-Arm DB Row': 'Single-Arm DB Row',
      'Cable Rear Delt Fly': 'Cable Rear Delt Fly',
      'Preacher Curls': 'Preacher Curls',
      'Incline DB Curls': 'Incline DB Curls',
      'Front Squat': 'Front Squat',
      'Bulgarian Split Squat': 'Bulgarian Split Squat',
      'Deadlift': 'Deadlift',
      'Hip Thrust': 'Hip Thrust',
      'Leg Extensions': 'Leg Extensions',
      'Standing Calf Raises': 'Standing Calf Raises'
    },
    notes: {
      'Heavy, focus on form': 'Heavy, focus on form',
      'Control descent': 'Control descent',
      'Weighted if possible': 'Weighted if possible',
      'Pendlay row variation': 'Pendlay row variation',
      'Focus on scapular retraction': 'Focus on scapular retraction',
      'Strict form': 'Strict form',
      'Feel the hamstrings': 'Feel the hamstrings',
      'Weight optional': 'Weight optional',
      'Control eccentric': 'Control eccentric',
      'Full range of motion': 'Full range of motion',
      'Upper chest focus': 'Upper chest focus',
      'Control tempo': 'Control tempo',
      'Full rotation': 'Full rotation',
      'Constant tension': 'Constant tension',
      'Keep elbows still': 'Keep elbows still',
      'Add weight if possible': 'Add weight if possible',
      'Focus on upper back': 'Focus on upper back',
      'Full stretch at top': 'Full stretch at top',
      'Feel the stretch': 'Feel the stretch',
      'Full glute squeeze': 'Full glute squeeze',
      'Hold peak contraction': 'Hold peak contraction'
    }
  },
  'ar': {
    title: 'خطة تدريب أمين شان المستندة إلى العلم',
    subtitle: 'برنامج يركز على التضخيم والقوة مستوحى من أساليب جيف نيبارد المستندة إلى الأدلة',
    weeklyOverview: 'نظرة عامة أسبوعية',
    frequency: 'التكرار',
    split: 'التقسيم',
    restDays: 'أيام الراحة',
    terminologyTitle: 'شرح مصطلحات التدريب',
    sets: 'المجموعات',
    setsExplanation: 'مجموعة من التكرارات تؤدى بشكل متتالي بدون راحة. على سبيل المثال، "3 مجموعات" تعني أنك ستؤدي التمرين ثلاث مرات مع فترات راحة بينها.',
    reps: 'التكرارات',
    repsExplanation: 'عدد المرات التي تؤدي فيها التمرين في المجموعة الواحدة. على سبيل المثال، "8-12 تكرار" تعني أنك ستؤدي الحركة من 8 إلى 12 مرة قبل الراحة.',
    day1: 'اليوم 1 - دفع (صدر، أكتاف، ترايسبس)',
    day2: 'اليوم 2 - سحب (ظهر، خلف الكتف، بايسبس)',
    day3: 'اليوم 3 - أرجل (فخذ أمامي، فخذ خلفي، أرداف)',
    day4: 'اليوم 4 - راحة/تعافي نشط',
    day5: 'اليوم 5 - دفع (حجم أعلى)',
    day6: 'اليوم 6 - سحب (تركيز على التراب والذراعين)',
    day7: 'اليوم 7 - أرجل (حجم أعلى)',
    jumpDay1: 'اليوم 1',
    jumpPush1: 'دفع',
    jumpDay2: 'اليوم 2',
    jumpPull1: 'سحب',
    jumpDay3: 'اليوم 3',
    jumpLegs1: 'أرجل',
    jumpDay4: 'اليوم 4',
    jumpRest: 'راحة',
    jumpDay5: 'اليوم 5',
    jumpPush2: 'دفع',
    jumpDay6: 'اليوم 6',
    jumpPull2: 'سحب',
    jumpDay7: 'اليوم 7',
    jumpLegs2: 'أرجل',
    footer: {
      quote: '"العلم يلتقي بالعرق – حقق أهدافك!"',
      copyright: ' 2024 خطة تدريب أمين شان المستندة إلى العلم'
    },
    exercises: {
      'Flat Barbell Bench Press': 'بنش بريس بالبار المسطح',
      'Incline Dumbbell Press': 'بنش بريس مائل بالدمبل',
      'Seated Overhead Dumbbell Press': 'بنش بريس علوى بالدمبل',
      'Lateral Raises': 'رفع جانبي',
      'Cable Tricep Pushdowns': 'دفع كابل ترايسيب',
      'Overhead Tricep Extensions': 'تمديد ترايسيب علوى',
      'Pull-Ups/Lat Pulldown': 'سحب للظهر/سحب بالبار',
      'Barbell Row': 'سحب بار بالبار',
      'Chest-Supported Dumbbell Row': 'سحب دمبل مدعوم بالصدر',
      'Face Pulls': 'سحب للوجه',
      'Barbell/Dumbbell Bicep Curls': 'ثني بايسبس بالبار/بالدمبل',
      'Hammer Curls': 'ثني بايسبس المطرقة',
      'Back Squat': 'سكوات خلفي',
      'Romanian Deadlift': 'رفع ميت رومانى',
      'Walking Lunges': 'لانجز مشي',
      'Leg Press': 'ضغط أرجل',
      'Hamstring Curls': 'ثني أوتار الركبة',
      'Calf Raises': 'رفع كعب',
      'Incline Barbell Bench': 'ضغط بار مائل',
      'Flat Dumbbell Press': 'ضغط دمبل مسطح',
      'Arnold Press': 'ضغط أرنولد',
      'Cable Lateral Raises': 'رفع جانبي كابل',
      'Skull Crushers': 'سحق جمجمة',
      'Dips': 'تمارين دبس',
      'Rack Pulls': 'سحب من الرف',
      'Wide-Grip Pulldown': 'سحب بقبضة واسعة',
      'Single-Arm DB Row': 'إحدى اليد سحب دمبل',
      'Cable Rear Delt Fly': 'طيران كتف خلفي بكابل',
      'Preacher Curls': 'ثني بايسبس بريسير',
      'Incline DB Curls': 'ثني بايسبس مائل بالدمبل',
      'Front Squat': 'سكوات أمامى',
      'Bulgarian Split Squat': 'سكوات مائل بلغاري',
      'Deadlift': 'رفع ميت',
      'Hip Thrust': 'دفع الورك',
      'Leg Extensions': 'تمديد الأرجل',
      'Standing Calf Raises': 'رفع كعب واقف'
    },
    notes: {
      'Heavy, focus on form': 'ثقيل، ركز على الشكل',
      'Control descent': 'تحكم في النزول',
      'Weighted if possible': 'استخدم وزن إن أمكن',
      'Pendlay row variation': 'نوعية سحب باندلاي',
      'Focus on scapular retraction': 'ركز على سحب الكتف',
      'Strict form': 'شكل صارم',
      'Feel the hamstrings': 'اشعر بأوتار الركبة',
      'Weight optional': 'الوزن اختياري',
      'Control eccentric': 'تحكم في النزول',
      'Full range of motion': 'مدى حركة كامل',
      'Upper chest focus': 'تركيز على الصدر العلوي',
      'Control tempo': 'تحكم في السرعة',
      'Full rotation': 'دوران كامل',
      'Constant tension': 'ضغط مستمر',
      'Keep elbows still': 'حافظ على ثبات الكوع',
      'Add weight if possible': 'أضف وزن إن أمكن',
      'Focus on upper back': 'ركز على الجزء العلوي من الظهر',
      'Full stretch at top': 'امتداد كامل في الأعلى',
      'Feel the stretch': 'اشعر بالامتداد',
      'Full glute squeeze': 'ضغط كامل للعضلة الألوية',
      'Hold peak contraction': 'احتفظ بالانقباض القوي'
    }
  },
  'nl': {
    title: 'Amin Shan Wetenschappelijk Onderbouwd Trainingsplan',
    subtitle: 'Een op hypertrofie en kracht gericht programma geïnspireerd door Jeff Nippard\'s evidence-based methoden',
    weeklyOverview: 'Wekelijks Overzicht',
    frequency: 'Frequentie',
    split: 'Split',
    restDays: 'Rustdagen',
    terminologyTitle: 'Trainingstermen Uitgelegd',
    sets: 'Sets',
    setsExplanation: 'Een groep herhalingen die achter elkaar worden uitgevoerd zonder rust. Bijvoorbeeld, "3 sets" betekent dat je de oefening drie keer uitvoert met rustperiodes ertussen.',
    reps: 'Herhalingen (Reps)',
    repsExplanation: 'Het aantal keren dat je een oefening uitvoert binnen een set. Bijvoorbeeld, "8-12 reps" betekent dat je de beweging 8 tot 12 keer uitvoert voordat je rust.',
    day1: 'Dag 1 - Push (Borst, Schouders, Triceps)',
    day2: 'Dag 2 - Pull (Rug, Achterste Schouders, Biceps)',
    day3: 'Dag 3 - Benen (Quadriceps, Hamstrings, Billen)',
    day4: 'Dag 4 - Rust/Actief Herstel',
    day5: 'Dag 5 - Push (Hoger Volume)',
    day6: 'Dag 6 - Pull (Trap/Arm Focus)',
    day7: 'Dag 7 - Benen (Hoger Volume)',
    jumpDay1: 'Dag 1',
    jumpPush1: 'Push',
    jumpDay2: 'Dag 2',
    jumpPull1: 'Pull',
    jumpDay3: 'Dag 3',
    jumpLegs1: 'Benen',
    jumpDay4: 'Dag 4',
    jumpRest: 'Rust',
    jumpDay5: 'Dag 5',
    jumpPush2: 'Push',
    jumpDay6: 'Dag 6',
    jumpPull2: 'Pull',
    jumpDay7: 'Dag 7',
    jumpLegs2: 'Benen',
    footer: {
      quote: '"Wetenschap ontmoet zweet – bereik je doelen!"',
      copyright: ' 2024 Amin Shan Wetenschappelijk Onderbouwd Trainingsplan'
    },
    exercises: {
      'Flat Barbell Bench Press': 'Vlakke Barbell Bankdrukken',
      'Incline Dumbbell Press': 'Schuine Dumbbell Press',
      'Seated Overhead Dumbbell Press': 'Zittende Overhead Dumbbell Press',
      'Lateral Raises': 'Zijwaartse Heffingen',
      'Cable Tricep Pushdowns': 'Kabel Tricep Pushdowns',
      'Overhead Tricep Extensions': 'Overhead Tricep Extensies',
      'Pull-Ups/Lat Pulldown': 'Pull-Ups/Lat Pulldown',
      'Barbell Row': 'Barbell Roeien',
      'Chest-Supported Dumbbell Row': 'Dumbbell Roeien met Steun',
      'Face Pulls': 'Gezicht Trek',
      'Barbell/Dumbbell Bicep Curls': 'Barbell/Dumbbell Bicep Curls',
      'Hammer Curls': 'Hammer Curls',
      'Back Squat': 'Achter Squat',
      'Romanian Deadlift': 'Roemeense Deadlift',
      'Walking Lunges': 'Wandelende Lunges',
      'Leg Press': 'Beenpers',
      'Hamstring Curls': 'Hamstring Curls',
      'Calf Raises': 'Kuitheffingen',
      'Incline Barbell Bench': 'Schuine Barbell Bankdrukken',
      'Flat Dumbbell Press': 'Vlakke Dumbbell Druk',
      'Arnold Press': 'Arnold Druk',
      'Cable Lateral Raises': 'Kabel Zijwaartse Heffingen',
      'Skull Crushers': 'Skull Crushers',
      'Dips': 'Dips',
      'Rack Pulls': 'Rack Pulls',
      'Wide-Grip Pulldown': 'Brede Grip Pulldown',
      'Single-Arm DB Row': 'Eén-Arms DB Roeien',
      'Cable Rear Delt Fly': 'Kabel Achterste Delt Fly',
      'Preacher Curls': 'Preacher Curls',
      'Incline DB Curls': 'Schuine DB Curls',
      'Front Squat': 'Front Squat',
      'Bulgarian Split Squat': 'Bulgaars Split Squat',
      'Deadlift': 'Deadlift',
      'Hip Thrust': 'Heup Duw',
      'Leg Extensions': 'Been Extensies',
      'Standing Calf Raises': 'Staande Kuitheffingen'
    },
    notes: {
      'Heavy, focus on form': 'Zwaar, focus op vorm',
      'Control descent': 'Controleer daling',
      'Weighted if possible': 'Gewicht indien mogelijk',
      'Pendlay row variation': 'Pendlay roeivariatie',
      'Focus on scapular retraction': 'Focus op scapulaire retractie',
      'Strict form': 'Strikte vorm',
      'Feel the hamstrings': 'Voel de hamstrings',
      'Weight optional': 'Gewicht indien mogelijk',
      'Control eccentric': 'Controleer excentrisch',
      'Full range of motion': 'Volledig bewegingsbereik',
      'Upper chest focus': 'Focus op bovenborst',
      'Control tempo': 'Controleer tempo',
      'Full rotation': 'Volledige rotatie',
      'Constant tension': 'Constante spanning',
      'Keep elbows still': 'Houd ellebogen stil',
      'Add weight if possible': 'Voeg gewicht toe indien mogelijk',
      'Focus on upper back': 'Focus op bovenrug',
      'Full stretch at top': 'Volledige rek bovenaan',
      'Feel the stretch': 'Voel de rek',
      'Full glute squeeze': 'Volledige bilcompressie',
      'Hold peak contraction': 'Houd piekcontractie vast'
    }
  }
};

function createWorkoutCard() {
  const newCard = document.createElement('div');
  newCard.className = 'workout-card';
  newCard.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
      <h3 class="editable-content" contenteditable="true">New Workout</h3>
      <button class="delete-card-btn" onclick="deleteWorkoutCard(this)" style="background: #ef4444; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">Delete Card</button>
    </div>
    <table class="workout-table">
      <thead>
        <tr>
          <th class="editable-content" contenteditable="true">Exercise</th>
          <th class="editable-content" contenteditable="true">Sets</th>
          <th class="editable-content" contenteditable="true">Reps</th>
          <th class="editable-content" contenteditable="true">Rest</th>
          <th class="editable-content" contenteditable="true">Notes</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input type="text" class="editable" value="New Exercise">
            <span class="exercise-link" onclick="showVideoModal(this.previousElementSibling)">&#128249;</span>
          </td>
          <td><input type="text" class="editable" value="3"></td>
          <td><input type="text" class="editable" value="8-12"></td>
          <td><input type="text" class="editable" value="90 sec"></td>
          <td><input type="text" class="editable" value="Form notes"></td>
        </tr>
      </tbody>
      <tr class="add-exercise-row">
        <td colspan="5" style="text-align: center; padding: 1rem;">
          <button onclick="addExerciseRow(this)" style="background: var(--primary); color: var(--background); padding: 0.5rem 1rem; border-radius: 0.5rem; border: none; cursor: pointer; font-weight: bold;">+ Add Exercise</button>
        </td>
      </tr>
    </table>
  `;
  document.querySelector('.schedule-grid').appendChild(newCard);
}

function createRestDayCard() {
  const newCard = document.createElement('div');
  newCard.className = 'workout-card';
  newCard.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
      <h3 class="editable-content" contenteditable="true">Rest/Active Recovery</h3>
      <button class="delete-card-btn" onclick="deleteWorkoutCard(this)" style="background: #ef4444; color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.5rem; cursor: pointer;">Delete Card</button>
    </div>
    <div class="info-card" style="margin-top: 1rem">
      <h4>Suggested Activities:</h4>
      <ul>
        <li>Light stretching</li>
        <li>Yoga</li>
        <li>Mobility work</li>
        <li>Light cardio (walking, swimming)</li>
      </ul>
      <p><em>Focus on recovery and flexibility</em></p>
    </div>
  `;
  document.querySelector('.schedule-grid').appendChild(newCard);
}

function deleteWorkoutCard(button) {
  if (confirm('Are you sure you want to delete this workout card?')) {
    button.closest('.workout-card').remove();
  }
}

function changeLanguage(lang) {
  document.querySelectorAll('[data-translate]').forEach(element => {
    const key = element.getAttribute('data-translate');
    const path = key.split('.');
    let translation = translations[lang];
    for (const segment of path) {
      if (translation) {
        translation = translation[segment];
      }
    }
    if (translation) {
      if (element.tagName === 'INPUT') {
        element.value = translation;
      } else if (element.hasAttribute('contenteditable')) {} else {
        element.textContent = translation;
      }
    }
  });
  document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
  document.querySelectorAll('.workout-table tbody tr').forEach(row => {
    const exerciseInput = row.querySelector('td:first-child input');
    const notesInput = row.querySelector('td:last-child input');
    if (exerciseInput && translations[lang].exercises) {
      const originalExercise = exerciseInput.getAttribute('data-original');
      if (originalExercise && translations[lang].exercises[originalExercise]) {
        exerciseInput.value = translations[lang].exercises[originalExercise];
      }
    }
    if (notesInput && translations[lang].notes) {
      const originalNote = notesInput.getAttribute('data-original');
      if (originalNote && translations[lang].notes[originalNote]) {
        notesInput.value = translations[lang].notes[originalNote];
      }
    }
  });
}

function resetWebsite() {
  if (!confirm("Are you sure you want to reset everything to the original state? This cannot be undone.")) {
    return;
  }
  window.location.reload();
}

function showVideoModal(exerciseElement) {
  const modal = document.createElement('div');
  modal.className = 'video-modal';
  modal.style.display = 'flex';
  const videoUrl = exerciseElement.getAttribute('data-video-url') || '';
  const exerciseName = exerciseElement.value || 'Exercise';
  modal.innerHTML = `
    <div class="video-modal-content">
      <div class="video-modal-header">
        <h3>${exerciseName}</h3>
        <button class="close-modal">&#215;</button>
      </div>
      <div class="video-container" id="video-container">
        ${videoUrl ? getEmbedCode(videoUrl) : '<p>No video added yet</p>'}
      </div>
      <input type="text" class="video-url-input" 
        placeholder="Enter YouTube URL" 
        value="${videoUrl}">
    </div>
  `;
  document.body.appendChild(modal);
  modal.querySelector('.close-modal').onclick = () => {
    document.body.removeChild(modal);
  };
  modal.onclick = e => {
    if (e.target === modal) {
      document.body.removeChild(modal);
    }
  };
  const urlInput = modal.querySelector('.video-url-input');
  urlInput.onchange = e => {
    const newUrl = e.target.value;
    exerciseElement.setAttribute('data-video-url', newUrl);
    const container = modal.querySelector('#video-container');
    container.innerHTML = newUrl ? getEmbedCode(newUrl) : '<p>No video added yet</p>';
  };
}

function getEmbedCode(url) {
  const videoId = url.match(/(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=))([\w\-]{10,12})\b/);
  if (videoId) {
    return `<iframe src="https://www.youtube.com/embed/${videoId[1]}" frameborder="0" allowfullscreen></iframe>`;
  }
  return '<p>Invalid YouTube URL</p>';
}

function saveWebsite() {
  const workoutData = [];
  document.querySelectorAll('.workout-card').forEach(card => {
    const dayTitle = card.querySelector('h3').textContent;
    const exercises = [];
    const table = card.querySelector('.workout-table');
    if (table) {
      table.querySelectorAll('tbody tr:not(.add-exercise-row)').forEach(row => {
        if (row.querySelector('td:nth-child(1) input')) {
          const exerciseInput = row.querySelector('td:nth-child(1) input');
          const videoUrl = exerciseInput.getAttribute('data-video-url');
          exercises.push({
            exercise: exerciseInput.value,
            sets: row.querySelector('td:nth-child(2) input')?.value || '',
            reps: row.querySelector('td:nth-child(3) input')?.value || '',
            rest: row.querySelector('td:nth-child(4) input')?.value || '',
            notes: row.querySelector('td:nth-child(5) input')?.value || '',
            videoUrl: videoUrl || ''
          });
        }
      });
    }
    workoutData.push({
      day: dayTitle,
      exercises: exercises,
      infoCard: card.querySelector('.info-card')?.innerHTML || ''
    });
  });

  const content = `
    <!DOCTYPE html>
    <html>
    <head>
      <title>Workout Plan</title>
      <style>
        :root {
          --primary: #60a5fa;
          --secondary: #94a3b8;
          --background: #0f172a;
          --text: #e2e8f0;
          --card-bg: #1e293b;
          --accent: #3b82f6;
          --hover: #1e40af;
        }
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; background: var(--background); color: var(--text); line-height: 1.6; padding: 40px; margin: 0; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: var(--primary); text-align: center; font-size: 2.5rem; margin-bottom: 1rem; }
        h2 { color: var(--primary); margin-top: 2rem; font-size: 1.8rem; border-bottom: 2px solid var(--hover); padding-bottom: 0.5rem; }
        .overview { background: var(--card-bg); padding: 2rem; border-radius: 1.5rem; margin: 2rem 0; box-shadow: 0 4px 20px -1px rgba(0,0,0,0.5); }
        table { width: 100%; border-collapse: separate; border-spacing: 0; margin: 1.5rem 0; background: var(--card-bg); border-radius: 0.75rem; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        th, td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--hover); }
        th { background: var(--card-bg); color: var(--primary); font-weight: bold; }
        tr:hover { background: rgba(96, 165, 250, 0.1); }
        .info-card { background: var(--card-bg); padding: 1.5rem; border-radius: 0.75rem; margin: 1rem 0; border: 1px solid var(--hover); }
        .footer { text-align: center; margin-top: 4rem; padding: 2rem; border-top: 1px solid var(--hover); color: var(--secondary); }
        .exercise-video-link { margin-left: 8px; color: var(--primary); text-decoration: none; cursor: pointer; }
        @media print {
          body { background: white; color: black; }
          .overview, table, .info-card { break-inside: avoid; }
          table { page-break-inside: avoid; }
        }
      </style>
    </head>
    <body>
      <div class="container">
        <svg class="logo" style="width: 120px; height: 120px;" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
          <g transform="translate(100, 150)" fill="#60a5fa">
            <rect x="0" y="40" width="200" height="20" rx="5"/>
            <rect x="-30" y="20" width="40" height="60" rx="5"/>
            <rect x="-60" y="30" width="40" height="40" rx="5"/>
            <rect x="190" y="20" width="40" height="60" rx="5"/>
            <rect x="220" y="30" width="40" height="40" rx="5"/>
          </g>
          <text x="200" y="280" text-anchor="middle" fill="#60a5fa" style="font-size: 16px; font-weight: bold;">
            DON'T BE FAT FUCK
          </text>
          <text x="200" y="320" text-anchor="middle" fill="#60a5fa" style="font-size: 26px; font-weight: bold;">
            BE FIT FUCK
          </text>
        </svg>
        <h1>${document.querySelector('.cover h1')?.textContent || 'Workout Plan'}</h1>
        <p style="text-align: center; font-size: 1.2rem; color: var(--secondary);">
          ${document.querySelector('.cover h2')?.textContent || ''}
        </p>
        <div class="overview">
          <h2>Weekly Overview</h2>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div class="info-card">
              <h3>Frequency</h3>
              <p>5–6 days per week</p>
            </div>
            <div class="info-card">
              <h3>Split</h3>
              <p>Push/Pull/Legs (PPL) with variations for volume and intensity</p>
            </div>
            <div class="info-card">
              <h3>Rest Days</h3>
              <p>1–2 (adjust based on recovery)</p>
            </div>
          </div>
        </div>
        ${workoutData.map(day => `
          <h2>${day.day}</h2>
          ${day.exercises.length > 0 ? `
            <table>
              <thead>
                <tr>
                  <th>Exercise</th>
                  <th>Sets</th>
                  <th>Reps</th>
                  <th>Rest</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                ${day.exercises.map(exercise => `
                  <tr>
                    <td>
                      ${exercise.exercise}
                      ${exercise.videoUrl ? `<a href="${exercise.videoUrl}" target="_blank" class="exercise-video-link">&#128249;</a>` : ''}
                    </td>
                    <td>${exercise.sets}</td>
                    <td>${exercise.reps}</td>
                    <td>${exercise.rest}</td>
                    <td>${exercise.notes}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          ` : `<div class="info-card">${day.infoCard}</div>`}
        `).join('')}
        <div class="footer">
          <p>${document.querySelector('.footer p:first-child')?.textContent || ''}</p>
          <p>${document.querySelector('.footer p:last-child')?.textContent || ''}</p>
        </div>
      </div>
    </body>
    </html>
  `;

  const blob = new Blob([content], { type: 'text/html' });
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'workout-plan.html';
  document.body.appendChild(a);
  a.click();
  setTimeout(() => {
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
  }, 0);
  alert('Your workout plan has been saved and downloaded!');
}

function addExerciseRow(button) {
  const tbody = button.closest('.workout-table').querySelector('tbody');
  const newRow = document.createElement('tr');
  newRow.innerHTML = `
    <td>
      <input type="text" class="editable" value="New Exercise">
      <span class="exercise-link" onclick="showVideoModal(this.previousElementSibling)">&#128249;</span>
    </td>
    <td><input type="text" class="editable" value="3"></td>
    <td><input type="text" class="editable" value="8-12"></td>
    <td><input type="text" class="editable" value="90 sec"></td>
    <td><input type="text" class="editable" value="Form notes"></td>
  `;
  tbody.appendChild(newRow);
}

// Initialize
document.getElementById('languageSelect').addEventListener('change', function (e) {
  const selectedLang = e.target.value;
  changeLanguage(selectedLang);
  localStorage.setItem('preferred-language', selectedLang);
});

// Restore language preference
window.addEventListener('load', () => {
  const savedLanguage = localStorage.getItem('preferred-language') || 'en';
  document.getElementById('languageSelect').value = savedLanguage;
  changeLanguage(savedLanguage);
});

// Make sure all functions are available globally
window.createWorkoutCard = createWorkoutCard;
window.createRestDayCard = createRestDayCard;
window.deleteWorkoutCard = deleteWorkoutCard;
window.resetWebsite = resetWebsite;
window.saveWebsite = saveWebsite;
window.addExerciseRow = addExerciseRow;
window.showVideoModal = showVideoModal;